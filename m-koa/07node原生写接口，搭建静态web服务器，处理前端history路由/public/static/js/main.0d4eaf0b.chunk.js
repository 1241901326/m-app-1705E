(this["webpackJsonpm-react-app-test"]=this["webpackJsonpm-react-app-test"]||[]).push([[0],{44:function(e,t,n){e.exports=n(79)},5:function(e,t,n){"use strict";var a=n(25),r=n.n(a),i=n(40),c=n(26),o=n.n(c),u="/api/login",l="/api/nav",s="/api/list",d="/api/add",m="/api/detail",p="/api/get_book_list",h="/api/delete",b="/api/update";var f=function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o()(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.a={login:function(e){return f({url:u,data:e,method:"post"})},getNav:function(){return f({url:l})},getList:function(e){return f({url:s+e})},add:function(e){return f({url:d,data:e,method:"post"})},getDetail:function(e){return f({url:m+e})},getBookList:function(){return f({url:p})},bookDelete:function(e){return f({url:h,data:e,method:"post"})},bookUpdate:function(e){return f({url:b,data:e,method:"post"})}}},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),c=n.n(i),o=n(17),u=n(15),l=n(7),s=n(8),d=n(10),m=n(9),p=n(11),h=n(16),b=n(39),f=n(5),v=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={username:"admin",password:"123456"},n.usernameRef=r.a.createRef(),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleInput",value:function(e,t){this.setState(Object(b.a)({},e,t.target.value))}},{key:"handleLogin",value:function(){var e=this,t=this.state,n=t.username,a=t.password;console.log(n,a),""===n.trim()?alert("\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a"):f.a.login({username:n,password:a}).then((function(t){200===t.data.code?(localStorage.setItem("username",t.data.data.username),e.props.history.push("/index/home")):alert(t.data.message)}))}},{key:"handleEnter",value:function(e){13===e.keyCode&&this.handleLogin()}},{key:"componentDidMount",value:function(){this.usernameRef.current.focus()}},{key:"render",value:function(){var e=this.state,t=e.username,n=e.password;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("input",{value:t,ref:this.usernameRef,onChange:this.handleInput.bind(this,"username"),placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),r.a.createElement("div",null,r.a.createElement("input",{value:n,onKeyUp:this.handleEnter.bind(this),onChange:this.handleInput.bind(this,"password"),type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})),r.a.createElement("button",{onClick:this.handleLogin.bind(this)},"\u767b\u5f55"))}}]),t}(a.Component),E=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleNav",value:function(e,t){var n=this;this.props.setState("currentIndex",e),this.props.setState("currentId",t),f.a.getList("?id=".concat(t)).then((function(e){200===e.data.code&&n.props.setState("currentList",e.data.data)}))}},{key:"componentDidMount",value:function(){var e=this;f.a.getNav().then((function(t){200===t.data.code&&e.props.setState("navList",t.data.data)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.navList,a=t.currentIndex,i=n.map((function(t,n){return r.a.createElement("span",{key:t.id,className:"m-nav-item "+(a===n?"active":""),onClick:e.handleNav.bind(e,n,t.id)},t.title)}));return r.a.createElement("div",null,i)}}]),t}(a.Component),k=Object(u.b)((function(e){return{navList:e.navList,currentIndex:e.currentIndex}}),(function(e){return{setState:function(t,n){e({type:"SET_STATE",key:t,value:n})}}}))(E),O=n(41),g=n.n(O),y=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"handleDetail",value:function(e){this.props.history.push("/index/home/detail/"+e)}},{key:"handleAdd",value:function(e){if(localStorage.getItem("username")){var t=this.props.bookList;e.checked=!0,e.count=1,t.push(e),this.props.setState("bookList",t),f.a.add({item:e}).then((function(e){e.data.code}))}else this.props.history.push("/login")}},{key:"componentDidMount",value:function(){var e=this;f.a.getList("?id=0").then((function(t){200===t.data.code&&e.props.setState("currentList",t.data.data)})),f.a.getBookList().then((function(t){200===t.data.code&&e.props.setState("bookList",t.data.data)})),this.props.setState("currentIndex",0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.currentList,a=t.bookList,i=n.map((function(t){return r.a.createElement("div",{key:t.id,className:"m-list-item"},r.a.createElement(g.a,{className:"m-loading-img"},r.a.createElement("img",{src:t.avatar,className:"m-list-img",alt:t.title})),r.a.createElement("div",{className:"m-list-info"},r.a.createElement("div",{className:"m-list-title"},t.title),r.a.createElement("div",{className:"m-list-price"},"\xa5 ",t.price),r.a.createElement("div",{className:"m-list-btn-wrap"},r.a.createElement("span",{className:"m-book-detail-btn",onClick:e.handleDetail.bind(e,t.id)},"\u4e66\u7c4d\u8be6\u60c5"),a.find((function(e){return e.id===t.id}))?r.a.createElement("span",{className:"m-book-disable-btn"},"\u5df2\u6536\u85cf"):r.a.createElement("span",{className:"m-book-detail-btn",onClick:e.handleAdd.bind(e,t)},"\u6536\u85cf"))))}));return r.a.createElement("div",null,i)}}]),t}(a.Component),j=Object(u.b)((function(e){return{currentList:e.currentList,bookList:e.bookList}}),(function(e){return{setState:function(t,n){e({type:"SET_STATE",key:t,value:n})}}}))(Object(h.g)(y)),L=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k,null),r.a.createElement(j,null))}}]),t}(a.Component),S=n(43),x=Object(u.b)((function(e){return{bookList:e.bookList}}),(function(e){return{setState:function(t,n){e({type:"SET_STATE",key:t,value:n})}}}))((function(e){var t=Object(a.useState)({}),n=Object(S.a)(t,2),i=n[0],c=n[1];Object(a.useEffect)((function(){var t=e.match.params.id;f.a.getDetail("?id=".concat(t)).then((function(e){200===e.data.code&&c(e.data.data)})),f.a.getBookList().then((function(e){e.data.code}))}),[]);var o=e.bookList;return r.a.createElement("div",null,r.a.createElement("img",{src:i.avatar,alt:i.title}),r.a.createElement("div",null,"\u4ef7\u683c\uff1a",i.price,"\u5143",o.find((function(e){return e.id===i.id}))?r.a.createElement("button",null,"\u5df2\u6536\u85cf"):r.a.createElement("button",{onClick:function(t){var n=e.bookList,a=JSON.parse(JSON.stringify(n));t.checked=!0,t.count=1,a.push(t),e.setState("bookList",a),f.a.add({item:t}).then((function(e){e.data.code}))}.bind(void 0,i)},"\u6536\u85cf")),r.a.createElement("div",null,"\u4f5c\u8005\uff1a",i.author),r.a.createElement("div",null,"\u5206\u6570\uff1a",i.score),r.a.createElement("div",null,"\u7b80\u4ecb\uff1a",i.summary))})),N=Object(a.lazy)((function(){return n.e(3).then(n.bind(null,80))})),I=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(o.b,{to:"/index/home",className:"m-nav-item"},"\u9996\u9875"),r.a.createElement(o.b,{to:"/index/book",className:"m-nav-item"},"\u4e66\u5305")),r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null,"loading...")},r.a.createElement(h.d,null,r.a.createElement(h.b,{exact:!0,path:"/index/home",component:L}),r.a.createElement(h.b,{path:"/index/book",render:function(){return localStorage.getItem("username")?r.a.createElement(N,null):r.a.createElement(h.a,{to:"/login"})}}),r.a.createElement(h.b,{path:"/index/home/detail/:id",component:x}))))}}]),t}(a.Component),C=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(h.d,null,r.a.createElement(h.a,{from:"/",to:"/login",exact:!0}),r.a.createElement(h.a,{from:"/index",to:"/index/home",exact:!0}),r.a.createElement(h.b,{path:"/login",component:v}),r.a.createElement(h.b,{path:"/index",component:I})))}}]),t}(a.Component),w=n(22),T={navList:[],currentIndex:0,currentId:0,currentList:[],bookList:[]},D=Object(w.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STATE":var n=JSON.parse(JSON.stringify(e));return n[t.key]=t.value,n;default:return e}}));n(78);c.a.render(r.a.createElement(u.a,{store:D},r.a.createElement(o.a,null,r.a.createElement(C,null))),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.0d4eaf0b.chunk.js.map